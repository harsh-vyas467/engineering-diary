🗓️ Date: 2025-08-01
📚 Topic: Spring Security Basics + CSRF + Custom Configuration

✅ Work Done
🔐 Spring Security Auto Configuration
When you add spring-boot-starter-security, Spring Security auto-configures basic authentication:

A login form is shown when accessing any endpoint.

Default username is user, and the auto-generated password appears in the console logs.

You can override default credentials using application.properties:

properties

  spring.security.user.name=admin  
  spring.security.user.password=admin@123

🛠️ Authentication via Postman
   - Use Basic Auth in Postman for endpoints secured by Spring Security. 
   - Provide the same username and password as above in the Authorization tab.

⚠️ Session Management & CSRF Risks
Once logged in, a session is created — reused for subsequent requests.

⚠️ Security Risk: If a malicious site captures your session ID (via CSRF), it can impersonate your session on sensitive applications like banking.

This is called Cross-Site Request Forgery (CSRF).

By default:

GET requests are allowed without CSRF tokens.

POST/PUT/DELETE require a valid CSRF token — else you get a 403 Forbidden.

🛡️ Working with CSRF
To fetch CSRF token (required for modifying requests):


@GetMapping("/csrf-token")
public CsrfToken getCsrfToken(HttpServletRequest request) {
return (CsrfToken) request.getAttribute("_csrf");
}
This will return:

{
"token": "lrvVB8Kco3LisCdeY3JhjDAiBDhPXXhiMXSyRVCkw1ZmRZK38o-wNPepl0rP1h87Vl9V7QVDKQF2aB5PCE2BczGc-jJUI6WG",
"headerName": "X-CSRF-TOKEN"
}

Set this token in headers for PUT/POST/DELETE requests:

X-CSRF-TOKEN: <token-value>

🧪 How to Inspect Session ID and CSRF
In browser:
Open DevTools → Application → Cookies → Look for session ID.

In Postman:
A different session ID and CSRF token are used compared to the browser.

Each tool/user is treated as a separate session.

⚙️ Custom Spring Security Configuration
Replaced default security with a more REST-friendly, custom configuration.

🔧 Key Changes in SecurityConfig:
✅ Replaced Spring Boot’s auto-configuration.

🔐 Enabled HTTP Basic Authentication.

🚫 Disabled:

Form login (no HTML forms, just REST API).

CSRF protection (not recommended for production without additional care).

🧑‍💻 Configured in-memory users with roles:

postman and admin

🔒 Used BCryptPasswordEncoder for secure password storage.

📦 Made app stateless:

Disabled session management (SessionCreationPolicy.STATELESS).

📌 Today’s Git Commits
Branch : https://github.com/harsh-vyas467/EMS/tree/spring-security
basic spring security implemented : https://github.com/harsh-vyas467/EMS/commit/cfed476490131b26da5f559cdc42e100a9dc8ac5
Configured custom Spring Security for a REST API by disabling CSRF, enabling stateless HTTP Basic authentication, and defining two in-memory users (postman, admin) with encrypted passwords using BCrypt: https://github.com/harsh-vyas467/EMS/commit/643a52792c907bf8ab8d716a75adbad69675036d

